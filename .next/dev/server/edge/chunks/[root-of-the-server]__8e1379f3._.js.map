{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/Downloads/New folder/middleware.ts"],"sourcesContent":["import type { NextRequest } from 'next/server'\nimport { NextResponse } from 'next/server'\n\nconst LAYERS = new Set(['europeans', 'americans', 'others'])\nconst LAYER_ROUTE_ROOTS = new Set(['', 'visas', 'process', 'requirements', 'resources', 'quiz'])\n\nexport function middleware(request: NextRequest) {\n  const { pathname } = request.nextUrl\n\n  // Ignore internal assets/api routes\n  if (\n    pathname.startsWith('/_next') ||\n    pathname.startsWith('/api') ||\n    pathname.startsWith('/static') ||\n    pathname.startsWith('/fonts') ||\n    pathname.startsWith('/images') ||\n    pathname.includes('.')\n  ) {\n    return NextResponse.next()\n  }\n\n  const userLayer = request.cookies.get('userLayer')?.value\n  if (!userLayer || !LAYERS.has(userLayer)) {\n    return NextResponse.next()\n  }\n\n  const segments = pathname.split('/').filter(Boolean)\n\n  // Already on correct layer path\n  if (segments.length > 0 && LAYERS.has(segments[0])) {\n    return NextResponse.next()\n  }\n\n  const firstSegment = segments[0] ?? ''\n  if (!LAYER_ROUTE_ROOTS.has(firstSegment)) {\n    return NextResponse.next()\n  }\n\n  const targetSegments = [userLayer, ...segments]\n  const targetPath = '/' + targetSegments.join('/')\n\n  const url = request.nextUrl.clone()\n  url.pathname = targetPath.replace(/\\/+$/, '') || `/${userLayer}`\n  return NextResponse.redirect(url)\n}\n\nexport const config = {\n  matcher: ['/((?!_next|api|static|fonts|images|.*\\\\..*).*)'],\n}\n\n\n\n\n\n\n\n\n\n\n\n"],"names":[],"mappings":";;;;;;AACA;AAAA;;AAEA,MAAM,SAAS,IAAI,IAAI;IAAC;IAAa;IAAa;CAAS;AAC3D,MAAM,oBAAoB,IAAI,IAAI;IAAC;IAAI;IAAS;IAAW;IAAgB;IAAa;CAAO;AAExF,SAAS,WAAW,OAAoB;IAC7C,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,oCAAoC;IACpC,IACE,SAAS,UAAU,CAAC,aACpB,SAAS,UAAU,CAAC,WACpB,SAAS,UAAU,CAAC,cACpB,SAAS,UAAU,CAAC,aACpB,SAAS,UAAU,CAAC,cACpB,SAAS,QAAQ,CAAC,MAClB;QACA,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,MAAM,YAAY,QAAQ,OAAO,CAAC,GAAG,CAAC,cAAc;IACpD,IAAI,CAAC,aAAa,CAAC,OAAO,GAAG,CAAC,YAAY;QACxC,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,MAAM,WAAW,SAAS,KAAK,CAAC,KAAK,MAAM,CAAC;IAE5C,gCAAgC;IAChC,IAAI,SAAS,MAAM,GAAG,KAAK,OAAO,GAAG,CAAC,QAAQ,CAAC,EAAE,GAAG;QAClD,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,MAAM,eAAe,QAAQ,CAAC,EAAE,IAAI;IACpC,IAAI,CAAC,kBAAkB,GAAG,CAAC,eAAe;QACxC,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,MAAM,iBAAiB;QAAC;WAAc;KAAS;IAC/C,MAAM,aAAa,MAAM,eAAe,IAAI,CAAC;IAE7C,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;IACjC,IAAI,QAAQ,GAAG,WAAW,OAAO,CAAC,QAAQ,OAAO,CAAC,CAAC,EAAE,WAAW;IAChE,OAAO,gMAAY,CAAC,QAAQ,CAAC;AAC/B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAiD;AAC7D"}}]
}